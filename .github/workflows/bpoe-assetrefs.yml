name: BPOE Asset XRefs
on:
  pull_request:
    branches: [ main ]
    paths-ignore:
      - 'public/bpoe/ASSET_GRAPH.json'
      - 'public/bpoe/ASSET_GRAPH.md'

jobs:
  xref:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup PowerShell 7
        uses: PowerShell/PowerShell@v1
        with:
          pwsh-version: '7.4.x'
      - name: Scan asset cross-references
        shell: pwsh
        run: |
          pwsh -NoProfile -File tools/BPOE/Scan-AssetRefs.ps1
      - name: Upload report
        uses: actions/upload-artifact@v4
        with:
          name: asset-xref-report
          path: |
            public/bpoe/ASSET_GRAPH.json
            public/bpoe/ASSET_GRAPH.md
